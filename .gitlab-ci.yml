image: maven:3.6.1-jdk-8-alpine

stages:
  - build

build:
  stage: build
  variables:
      MAVEN_OPTS: -Dmaven.repo.local=my_m2/repository
      BUILD_NUMBER: ${CI_COMMIT_REF_SLUG}-${CI_JOB_ID}

  cache:
    key: ${CI_COMMIT_REF_SLUG}
    paths:
      - my_m2/repository
  script: mvn package -Dbuild.number=${BUILD_NUMBER}
  artifacts:
      paths:
        - target/rpki-ta-0-*-${BUILD_NUMBER}-dist.tar.gz
